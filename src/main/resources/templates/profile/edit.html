<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layouts/base :: base(~{this::content})}">
    <th:block th:fragment="content">

        <!-- TODO 회원 정보 수정 디자인 & 기능 구현 -->
    <h1>프로필 수정 페이지 영역</h1>

    <div name="profile">  <!--  회원 프로필 영역  -->
        <form action="" th:action th:object="${member}" name="inputForm" method="post">
        <span name="imageInfo">  <!--  회원 프로필 사진 영역  -->
            <div name="memberImage"></div>  <!--  회원 프로필 사진  -->
            <div name="button">  <!--  버튼 영역  -->
                <span name="delete-button">
                    <button type="button" class="btn btn-danger">삭제</button>
                </span>
                <span name="edit-button">
                    <button type="button" class="btn btn-warning">수정</button>
                </span>
            </div>
        </span>
        <span name="memberInfo">  <!--  회원 정보 영역  -->
            <div name="username">  <!--  닉네임 영역  -->
                <span name="username-textbox">닉네임</span>
                <input type="text" th:field="*{username}" placeholder="닉네임">
                <span name="submit-button">
                    <button type="button" id="checkUsernameBtn">중복확인</button>
                </span>
            </div>
            <div name="location">지역  <!--  위치 영역  -->
                <span name="location-dropdown"></span>
                        <select th:field="*{location}">
                            <option th:value="SEOUL">서울</option>
                            <option th:value="BUSAN">부산</option>
                            <option th:value="DAEGU">대구</option>
                            <option th:value="INCHEON">인천</option>
                            <option th:value="GWANGJU">광주</option>
                            <option th:value="DAEJEON">대전</option>
                            <option th:value="ULSAN">울산</option>
                            <option th:value="SEJONG">세종</option>
                            <option th:value="GYEONGGI">경기</option>
                            <option th:value="GANGWON">강원</option>
                            <option th:value="CHUNGBUK">충북</option>
                            <option th:value="CHUNGNAM">충남</option>
                            <option th:value="JEONBUK">전북</option>
                            <option th:value="JEONNAM">전남</option>
                            <option th:value="GYEONGBUK">경북</option>
                            <option th:value="GYEONGNAM">경남</option>
                            <option th:value="JEJU">제주</option>
                            <option th:value="ETC">기타</option>
                        </select>
                <span name="location-checkbox">
                    <input type="checkbox" >
                </span>
            </div>
            <div name="introduce">자기소개
                <input type="text" th:field="*{introduction}" placeholder="자기소개">
            </div>
        </span>
    </div>
    <div name="genre">  <!-- 관심사 영역 -->
        <div name="heading">관심사</div>  <!--  제목  -->
        <div name="cards">  <!--  관심사 카드 영역 상단  -->
            <h1>카드 영역</h1>
            <form action="" th:action th:object="${interestForm}" method="post">
            <span name="card">
                <div name="image"></div>
                <input type="checkbox" th:field="*{interestList}" th:value="DRAMA">
                <div name="title">연극</div>
            </span>
            <span name="card">
                <div name="image"></div>
                <input type="checkbox" th:field="*{interestList}" th:value="CONCERT">
                <div name="title">음악/콘서트</div>
            </span>
            <span name="card">
                <div name="image"></div>
                <input type="checkbox" th:field="*{interestList}" th:value="EXHIBITION">
                <div name="title">전시</div>
            </span>
            <span name="card">
                <div name="image"></div>
                <input type="checkbox" th:field="*{interestList}" th:value="MUSICAL">
                <div name="title">뮤지컬/오페라</div>
            </span>
            <span name="card">
                <div name="image"></div>
                <input type="checkbox" th:field="*{interestList}" th:value="ETC">
                <div name="title">기타</div>
            </span>
        </div>
        <!--<div name="cards">  &lt;!&ndash;  관심사 카드 영역 하단  &ndash;&gt;
            <h1>카드 영역</h1>
            <span name="card">
                <div name="image"></div>
                <div name="title"></div>
            </span>
            <span name="card">
                <div name="image"></div>
                <div name="title"></div>
            </span><span name="card">
                <div name="image"></div>
                <div name="title"></div>
            </span><span name="card">
                <div name="image"></div>
                <div name="title"></div>
            </span>
        </div>-->
        <div name="submit-button">
            <button type="submit">저장하기</button>
        </div>
    </div>
    </form>
    </th:block>
</th:block>
<script th:inline="javascript">
    $(document).ready(function(){
        let checkResult = null;

        $("#username").change(function(){
            let username = $(this).val(); // 사용자가 작성한 값 꺼내기
            console.log("username : " + username);
            $.ajax({
                type: "post",
                url: "/usernameCheck",
                data: {username: username},
                success: function(result){
                    console.log("성공!");
                    console.log(result);
                    checkResult = result; // 성공 결과 저장
                },
                error: function(e) {
                    console.log("실패...");
                    console.log(e);
                }
            });
        });
        $("#checkUsernameBtn").click(function(){
            if(checkResult !== null) {
                alert(checkResult); // 마지막 AJAX 호출 결과 사용
            } else {
                alert("닉네임 중복확인을 해주세요.");
            }
        });
    });
</script>
</html>